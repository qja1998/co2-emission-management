{"ast":null,"code":"import { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createBlock as _createBlock, withCtx as _withCtx, createVNode as _createVNode, toDisplayString as _toDisplayString, vModelSelect as _vModelSelect, withDirectives as _withDirectives } from \"vue\";\nconst _hoisted_1 = {\n  style: {\n    \"padding\": \"15vh\"\n  }\n};\nconst _hoisted_2 = {\n  style: {\n    \"font-size\": \"4vh\"\n  }\n};\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"div\", {\n  style: {\n    \"font-size\": \"2vh\",\n    \"font-weight\": \"normal\",\n    \"margin-top\": \"4vh\"\n  }\n}, [/*#__PURE__*/_createTextVNode(\"엑셀파일을 이용하여 전력 사용에 대한 데이터를 한번에 등록할 수 있습니다.\"), /*#__PURE__*/_createElementVNode(\"br\"), /*#__PURE__*/_createTextVNode(\" 정해진 엑셀 양식을 다운로드 받아 양식에 따라 데이터를 작성 후 엑셀 파일을 업로드하면 전력 사용 내역이 일괄 등록됩니다. \")], -1 /* HOISTED */);\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"button\", {\n  class: \"excel-down-btn\"\n}, \"엑셀 양식 다운로드\", -1 /* HOISTED */);\nconst _hoisted_5 = {\n  style: {\n    \"border\": \"1px solid #D4D4D4\",\n    \"padding\": \"3vh 2vw 2vw 5vh\",\n    \"margin-top\": \"5vh\",\n    \"border-radius\": \"1vh\"\n  }\n};\nconst _hoisted_6 = /*#__PURE__*/_createElementVNode(\"span\", {\n  style: {\n    \"font-size\": \"2vh\",\n    \"font-weight\": \"bold\",\n    \"margin-right\": \"2vw\"\n  }\n}, \" 파일 선택 \", -1 /* HOISTED */);\nconst _hoisted_7 = [\"value\"];\nconst _hoisted_8 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_xlsx_sheet = _resolveComponent(\"xlsx-sheet\");\n  const _component_xlsx_download = _resolveComponent(\"xlsx-download\");\n  const _component_xlsx_workbook = _resolveComponent(\"xlsx-workbook\");\n  const _component_xlsx_sheets = _resolveComponent(\"xlsx-sheets\");\n  const _component_xlsx_json = _resolveComponent(\"xlsx-json\");\n  const _component_xlsx_read = _resolveComponent(\"xlsx-read\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createTextVNode(\"엑셀 파일로 일괄 등록 \"), _hoisted_3, _createElementVNode(\"section\", null, [_createVNode(_component_xlsx_workbook, null, {\n    default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.sheets, sheet => {\n      return _openBlock(), _createBlock(_component_xlsx_sheet, {\n        collection: sheet.data,\n        key: sheet.name,\n        \"sheet-name\": sheet.name\n      }, null, 8 /* PROPS */, [\"collection\", \"sheet-name\"]);\n    }), 128 /* KEYED_FRAGMENT */)), _createVNode(_component_xlsx_download, null, {\n      default: _withCtx(() => [_hoisted_4]),\n      _: 1 /* STABLE */\n    })]),\n\n    _: 1 /* STABLE */\n  })]), _createElementVNode(\"div\", _hoisted_5, [_hoisted_6, _createElementVNode(\"input\", {\n    type: \"file\",\n    onChange: _cache[0] || (_cache[0] = (...args) => $setup.onChange && $setup.onChange(...args))\n  }, null, 32 /* HYDRATE_EVENTS */), _createVNode(_component_xlsx_read, {\n    file: $setup.file\n  }, {\n    default: _withCtx(() => [_createVNode(_component_xlsx_sheets, null, {\n      default: _withCtx(({\n        sheets\n      }) => [_withDirectives(_createElementVNode(\"select\", {\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.selectedSheet = $event)\n      }, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(sheets, sheet => {\n        return _openBlock(), _createElementBlock(\"option\", {\n          key: sheet,\n          value: sheet\n        }, _toDisplayString(sheet), 9 /* TEXT, PROPS */, _hoisted_7);\n      }), 128 /* KEYED_FRAGMENT */))], 512 /* NEED_PATCH */), [[_vModelSelect, $setup.selectedSheet]])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_xlsx_json, {\n      sheet: $setup.selectedSheet\n    }, {\n      default: _withCtx(({\n        collection\n      }) => [_createElementVNode(\"button\", {\n        class: \"clickbtn\",\n        style: {\n          \"float\": \"right\",\n          \"margin-top\": \"5vh\"\n        },\n        onClick: $event => $setup.registerExcel(collection)\n      }, \"엑셀 등록하기\", 8 /* PROPS */, _hoisted_8)]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"sheet\"])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"file\"])])])]);\n}","map":{"version":3,"names":["style","_createElementVNode","class","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_createVNode","_component_xlsx_workbook","_Fragment","_renderList","$setup","sheets","sheet","_createBlock","_component_xlsx_sheet","collection","data","key","name","_component_xlsx_download","_hoisted_4","_hoisted_5","_hoisted_6","type","onChange","_cache","args","_component_xlsx_read","file","_component_xlsx_sheets","default","_withCtx","selectedSheet","$event","value","_hoisted_7","_component_xlsx_json","onClick","registerExcel","_hoisted_8"],"sources":["C:\\Users\\gpal6\\carbonCap\\co2-emission-management\\vueProject\\src\\components\\measure\\Divide-carbon\\excel\\Water_usage_excel.vue"],"sourcesContent":["<template>\r\n    <div style=\"padding:15vh\">\r\n        <div style=\"font-size:4vh;\">엑셀 파일로 일괄 등록\r\n          <div style=\"font-size:2vh; font-weight:normal; margin-top:4vh\">엑셀파일을 이용하여 전력 사용에 대한 데이터를 한번에 등록할 수 있습니다.<br>\r\n            정해진 엑셀 양식을 다운로드 받아 양식에 따라 데이터를 작성 후 엑셀 파일을 업로드하면 전력 사용 내역이 일괄 등록됩니다.\r\n          </div>\r\n\r\n            <section>\r\n                <xlsx-workbook>\r\n                  <xlsx-sheet\r\n                      :collection=\"sheet.data\"\r\n                      v-for=\"sheet in sheets\"\r\n                      :key=\"sheet.name\"\r\n                      :sheet-name=\"sheet.name\"\r\n                  />\r\n                  <xlsx-download>\r\n                      <button class=\"excel-down-btn\">엑셀 양식 다운로드</button>\r\n                  </xlsx-download>\r\n                </xlsx-workbook>\r\n            </section>\r\n\r\n            <div style=\"border:1px solid #D4D4D4; padding:3vh 2vw 2vw 5vh; margin-top:5vh; border-radius: 1vh;\">\r\n              <span style=\"font-size:2vh; font-weight:bold; margin-right:2vw\"> 파일 선택 </span>\r\n              <input type=\"file\" @change=\"onChange\" />\r\n              <xlsx-read :file=\"file\">\r\n                <xlsx-sheets>\r\n                  <template #default=\"{sheets}\">\r\n                    <select v-model=\"selectedSheet\">\r\n                      <option v-for=\"sheet in sheets\" :key=\"sheet\" :value=\"sheet\">\r\n                        {{ sheet }}\r\n                      </option>\r\n                    </select>\r\n                  </template>\r\n                </xlsx-sheets>\r\n                <xlsx-json :sheet=\"selectedSheet\">\r\n                  <template #default=\"{collection}\">\r\n                    <button class =\"clickbtn\" style=\"float:right; margin-top:5vh\" @click=\"registerExcel(collection)\">엑셀 등록하기</button>\r\n                  </template>\r\n                </xlsx-json>\r\n              </xlsx-read>\r\n            </div>\r\n            \r\n        </div>\r\n      \r\n\r\n\r\n      \r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import { XlsxRead, XlsxTable, XlsxSheets, XlsxJson, XlsxWorkbook, XlsxSheet, XlsxDownload } from \"vue3-xlsx\"\r\n  import {useStore} from 'vuex'\r\n  import {ref} from 'vue'\r\n  export default {\r\n    components: {\r\n      XlsxRead,\r\n      XlsxTable,\r\n      XlsxSheets,\r\n      XlsxJson,\r\n      XlsxWorkbook,\r\n      XlsxSheet,\r\n      XlsxDownload\r\n    },\r\n\r\n    setup(){\r\n      var file= ref(null)\r\n      var selectedSheet=ref(null)\r\n      var sheetName=ref(null)\r\n      var sheets=ref([\r\n        { name: \"전력사용양식\", \r\n          data: [\r\n            { 탄소배출내용: String, 시작날짜: Date, 시작날짜:Date, 배출시설명:null, 배출주체:null,공급처:null, 수도사용량:Number}\r\n          ] \r\n        }\r\n      ])\r\n      var collection=ref([{a:1, b:2}])\r\n      var store = useStore()\r\n\r\n      function onChange(event){\r\n        file.value = event.target.files ? event.target.files[0] : null;\r\n      }\r\n\r\n      function addSheet(){\r\n        sheets.push({ name: this.sheetName, data: [...this.collection] });\r\n        sheetName.value = '전력사용양식';\r\n      }\r\n      function registerExcel(sheets){\r\n        var i\r\n        for(i=0; i<sheets.length; i++){\r\n          console.log(i)\r\n          var info_list={\r\n            Type:\"10\",\r\n            DetailType:\"수도\",\r\n            StartDate: excelSerialDateToJSDate(sheets[i].시작날짜),\r\n            EndDate:excelSerialDateToJSDate(sheets[i].시작날짜),\r\n            Location:\"\",\r\n            scope:2,\r\n            data:sheets[i].수도사용량+\"/\"+'kg',\r\n            emissions:sheets[i].수도사용량+4,\r\n            Carbonunit:\"kg\",\r\n            CarbonActivity:sheets[i].탄소배출내용,\r\n            kind:\"\",\r\n            Division:{건물명:\"\",운영주체:\"\",공급처:\"\"}\r\n          }\r\n          console.log(info_list)\r\n          \r\n          store.commit(\"SetTableContent\",info_list)\r\n        }\r\n      }\r\n      \r\n      //엑셀 날짜 받아와서 타입에 맞춰 바꾸는 함수\r\n      function formatDate(date) {\r\n        var d = new Date(date),\r\n            month = '' + (d.getMonth() + 1),\r\n            day = '' + d.getDate(),\r\n            year = d.getFullYear();\r\n\r\n        if (month.length < 2) \r\n            month = '0' + month;\r\n        if (day.length < 2) \r\n            day = '0' + day;\r\n\r\n        return [year, month, day].join('-');\r\n      }\r\n      function excelSerialDateToJSDate (excelSerialDate) {\r\n        const daysBeforeUnixEpoch = 70 * 365 + 19;\r\n        const hour = 60 * 60 * 1000;\r\n        return formatDate(new Date(Math.round((excelSerialDate - daysBeforeUnixEpoch) * 24 * hour) + 12 * hour));\r\n      };\r\n      \r\n\r\n      return{\r\n        file,\r\n        selectedSheet,\r\n        sheetName,\r\n        sheets,\r\n        collection,\r\n        onChange,\r\n        addSheet,\r\n        registerExcel\r\n      }\r\n    },\r\n    methods: {\r\n\r\n      \r\n    }\r\n  };\r\n  </script>\r\n\r\n<style>\r\n  .excel-down-btn{\r\n    margin-top:3vh; \r\n    background: none; \r\n    border:none; \r\n    font-size:2vh; \r\n    color:#4FB0DA;\r\n    text-decoration: underline;\r\n  }\r\n  .excel-down-btn:hover{\r\n    cursor: pointer;\r\n  }\r\n</style>"],"mappings":";;EACSA,KAAoB,EAApB;IAAA;EAAA;AAAoB;;EAChBA,KAAsB,EAAtB;IAAA;EAAA;AAAsB;gCACzBC,mBAAA,CAEM;EAFDD,KAAyD,EAAzD;IAAA;IAAA;IAAA;EAAA;AAAyD,I,8BAAC,2CAAyC,G,aAAAC,mBAAA,CAAI,O,8BAAA,wEAE5G,E;gCAWYA,mBAAA,CAAkD;EAA1CC,KAAK,EAAC;AAAgB,GAAC,YAAU;;EAK9CF,KAA8F,EAA9F;IAAA;IAAA;IAAA;IAAA;EAAA;AAA8F;gCACjGC,mBAAA,CAA8E;EAAxED,KAAyD,EAAzD;IAAA;IAAA;IAAA;EAAA;AAAyD,GAAC,SAAO;;;;;;;;;;uBArBjFG,mBAAA,CA8CM,OA9CNC,UA8CM,GA7CFH,mBAAA,CAwCM,OAxCNI,UAwCM,G,iBAxCsB,eAC1B,GAAAC,UAEM,EAEJL,mBAAA,CAYU,kBAXNM,YAAA,CAUgBC,wBAAA;sBAPV,MAAuB,E,kBAF3BL,mBAAA,CAKEM,SAAA,QAAAC,WAAA,CAHkBC,MAAA,CAAAC,MAAM,EAAfC,KAAK;2BAFhBC,YAAA,CAKEC,qBAAA;QAJGC,UAAU,EAAEH,KAAK,CAACI,IAAI;QAEtBC,GAAG,EAAEL,KAAK,CAACM,IAAI;QACf,YAAU,EAAEN,KAAK,CAACM;;oCAEvBZ,YAAA,CAEgBa,wBAAA;wBADZ,MAAkD,CAAlDC,UAAkD,C;;;;;QAK5DpB,mBAAA,CAmBM,OAnBNqB,UAmBM,GAlBJC,UAA8E,EAC9EtB,mBAAA,CAAwC;IAAjCuB,IAAI,EAAC,MAAM;IAAEC,QAAM,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEhB,MAAA,CAAAc,QAAA,IAAAd,MAAA,CAAAc,QAAA,IAAAE,IAAA,CAAQ;qCACpCpB,YAAA,CAeYqB,oBAAA;IAfAC,IAAI,EAAElB,MAAA,CAAAkB;EAAI;sBACpB,MAQc,CARdtB,YAAA,CAQcuB,sBAAA;MAPDC,OAAO,EAAAC,QAAA,CAChB,CAIS;QALUpB;MAAM,O,gBACzBX,mBAAA,CAIS;mEAJQU,MAAA,CAAAsB,aAAa,GAAAC,MAAA;6BAC5B/B,mBAAA,CAESM,SAAA,QAAAC,WAAA,CAFeE,MAAM,EAAfC,KAAK;6BAApBV,mBAAA,CAES;UAFwBe,GAAG,EAAEL,KAAK;UAAGsB,KAAK,EAAEtB;4BAChDA,KAAK,wBAAAuB,UAAA;+EAFKzB,MAAA,CAAAsB,aAAa,E;;QAOlC1B,YAAA,CAIY8B,oBAAA;MAJAxB,KAAK,EAAEF,MAAA,CAAAsB;IAAa;MACnBF,OAAO,EAAAC,QAAA,CAChB,CAAiH;QAD9FhB;MAAU,OAC7Bf,mBAAA,CAAiH;QAAzGC,KAAK,EAAE,UAAU;QAACF,KAAmC,EAAnC;UAAA;UAAA;QAAA,CAAmC;QAAEsC,OAAK,EAAAJ,MAAA,IAAEvB,MAAA,CAAA4B,aAAa,CAACvB,UAAU;SAAG,SAAO,iBAAAwB,UAAA,E"},"metadata":{},"sourceType":"module","externalDependencies":[]}